---
import url from "url";
import { Icon } from "astro-icon/components";

const currentFilter = Astro.url.searchParams.get("filter");

const links = [
  {
    label: "news",
    path: "/",
  },
  {
    label: "ask",
    path: "/ask",
  },
  {
    label: "show",
    path: "/show",
  },
];

const isSelected = (path: string) => {
  return Astro.url.pathname === path;
};

const getUrl = (path: string) => {
  const parsedUrl = url.parse(path, true);
  if (currentFilter) parsedUrl.query["filter"] = currentFilter;
  return url.format(parsedUrl);
};
---

<nav class="h-14 w-full border-b border-neutral-500/40 bg-black px-3">
  <main class="m-auto flex h-full w-full max-w-screen-md items-center justify-between">
    <a class="text-xl font-extrabold text-white hover:no-underline" href="/">[HN]</a>
    <div class="box-border flex items-center gap-3">
      {
        links.map((link) => (
          <a href={getUrl(link.path)} class={isSelected(link.path) ? "font-bold" : ""}>
            {link.label}
          </a>
        ))
      }
      <label
        for="q"
        class="block cursor-pointer rounded-md border border-neutral-500/40 p-2 text-white"
      >
        <Icon name="search" class="h-5 w-5" />
      </label>
    </div>
  </main>
</nav>
