---
import url from "url";
import { Icon } from "astro-icon/components";

const currentFilter = Astro.url.searchParams.get("filter");
const currentPage = Astro.url.searchParams.get("page");

const categories = [
  {
    label: "Trending",
    icon: "star",
    filter: null,
  },
  {
    label: "Most upvoted",
    icon: "upvote",
    filter: "top",
  },
  {
    label: "Newest",
    icon: "clock",
    filter: "new",
  },
];

const getUrl = (filter: string | null) => {
  const parsedUrl = url.parse(Astro.url.pathname, true);
  if (currentPage) parsedUrl.query["page"] = currentPage;
  if (filter) parsedUrl.query["filter"] = filter;
  return url.format(parsedUrl);
};
---

<div class="flex justify-center gap-3 text-sm sm:justify-start sm:text-base">
  {
    categories.map((category) => (
      <a
        href={getUrl(category.filter)}
        class={`${
          currentFilter === category.filter && "font-bold"
        } flex items-center justify-center gap-1`}
      >
        <Icon name={category.icon} class="h-5 w-5" />
        <span>{category.label}</span>
      </a>
    ))
  }
</div>
